"use strict";(globalThis.webpackChunkvbrowser_documentation=globalThis.webpackChunkvbrowser_documentation||[]).push([[307],{3099(e,n,r){r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"getting-started/architecture","title":"Architecture","description":"Open vBrowser (OvB) is built as a cloud-native, container-first platform that combines local orchestration, automated infrastructure provisioning, and ephemeral browser workloads. Its architecture is designed to maximize isolation, repeatability, and operator control while minimizing long-lived state.","source":"@site/docs/getting-started/architecture.md","sourceDirName":"getting-started","slug":"/getting-started/architecture","permalink":"/docs/getting-started/architecture","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"Prerequisites","permalink":"/docs/getting-started/prerequisites"},"next":{"title":"Security Model","permalink":"/docs/getting-started/security-model"}}');var s=r(4848),t=r(8453);const l={sidebar_position:3},o="Architecture",c={},a=[{value:"High-Level Architecture Diagram",id:"high-level-architecture-diagram",level:2},{value:"High-Level Components",id:"high-level-components",level:2},{value:"Local Orchestration Layer",id:"local-orchestration-layer",level:2},{value:"Browser Image Selection Flow",id:"browser-image-selection-flow",level:2},{value:"Infrastructure Provisioning Layer",id:"infrastructure-provisioning-layer",level:2},{value:"Environment Propagation Model",id:"environment-propagation-model",level:2},{value:"Image Management Layer (containers-updater)",id:"image-management-layer-containers-updater",level:2},{value:"Application Runtime Layer (vBrowser Backend)",id:"application-runtime-layer-vbrowser-backend",level:2},{value:"Browser Execution Layer",id:"browser-execution-layer",level:2},{value:"Data Flow Summary",id:"data-flow-summary",level:2},{value:"Trust &amp; Isolation Boundaries",id:"trust--isolation-boundaries",level:2},{value:"Design Principles",id:"design-principles",level:2},{value:"Next Steps",id:"next-steps",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"architecture",children:"Architecture"})}),"\n",(0,s.jsxs)(n.p,{children:["Open vBrowser (OvB) is built as a ",(0,s.jsx)(n.strong,{children:"cloud-native, container-first platform"})," that combines local orchestration, automated infrastructure provisioning, and ephemeral browser workloads. Its architecture is designed to maximize isolation, repeatability, and operator control while minimizing long-lived state."]}),"\n",(0,s.jsxs)(n.p,{children:["This document explains how OvB works ",(0,s.jsx)(n.strong,{children:"end-to-end"}),", from setup to runtime."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"high-level-architecture-diagram",children:"High-Level Architecture Diagram"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"OvB Architecture Diagram",src:r(8566).A+"",width:"1500",height:"700"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"high-level-components",children:"High-Level Components"}),"\n",(0,s.jsx)(n.p,{children:"OvB consists of five primary architectural layers:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Local Orchestration Layer"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Infrastructure Provisioning Layer"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Image Management Layer"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Application Runtime Layer"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Browser Execution Layer"})}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Each layer has a single responsibility and minimal trust in the others."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"local-orchestration-layer",children:"Local Orchestration Layer"}),"\n",(0,s.jsxs)(n.p,{children:["The entry point for OvB is the ",(0,s.jsx)(n.code,{children:"setup.sh"})," script, executed from the ",(0,s.jsx)(n.code,{children:"terraform/"})," directory."]}),"\n",(0,s.jsx)(n.p,{children:"Responsibilities:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Browser image selection"}),"\n",(0,s.jsx)(n.li,{children:"Environment variable collection"}),"\n",(0,s.jsx)(n.li,{children:"Secure secret generation"}),"\n",(0,s.jsx)(n.li,{children:"Terraform configuration patching"}),"\n",(0,s.jsx)(n.li,{children:"Docker image builds"}),"\n",(0,s.jsx)(n.li,{children:"Service startup"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["The setup script is ",(0,s.jsx)(n.strong,{children:"idempotent by design"})," and may be safely re-run after teardown."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"browser-image-selection-flow",children:"Browser Image Selection Flow"}),"\n",(0,s.jsxs)(n.p,{children:["OvB treats browsers as ",(0,s.jsx)(n.strong,{children:"pluggable execution units"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"During setup:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["A default browser set is offered (",(0,s.jsx)(n.code,{children:"chrome"}),", ",(0,s.jsx)(n.code,{children:"mullvad"}),", ",(0,s.jsx)(n.code,{children:"tor"}),")"]}),"\n",(0,s.jsx)(n.li,{children:"Operators may select a custom subset"}),"\n",(0,s.jsxs)(n.li,{children:["Unused browser directories are moved to ",(0,s.jsx)(n.code,{children:"unused/"})]}),"\n",(0,s.jsxs)(n.li,{children:["Selected browser directories remain in ",(0,s.jsx)(n.code,{children:"vbrowsers/"})]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"This mechanism ensures:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Only explicitly approved browsers are built"}),"\n",(0,s.jsx)(n.li,{children:"Reduced image build time"}),"\n",(0,s.jsx)(n.li,{children:"Smaller ECR footprint"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["The selected browser list is written into ",(0,s.jsx)(n.code,{children:"terraform.tfvars"})," as ",(0,s.jsx)(n.code,{children:"docker_images"}),"."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"infrastructure-provisioning-layer",children:"Infrastructure Provisioning Layer"}),"\n",(0,s.jsxs)(n.p,{children:["Terraform is used to provision ",(0,s.jsx)(n.strong,{children:"all cloud infrastructure"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"Provisioned resources include:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"ECS cluster"}),"\n",(0,s.jsx)(n.li,{children:"ECS task definitions"}),"\n",(0,s.jsx)(n.li,{children:"ECS services"}),"\n",(0,s.jsx)(n.li,{children:"ECR repositories"}),"\n",(0,s.jsx)(n.li,{children:"IAM roles and policies"}),"\n",(0,s.jsx)(n.li,{children:"Networking primitives"}),"\n",(0,s.jsx)(n.li,{children:"CloudWatch log groups"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Terraform is executed automatically:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"terraform init\nterraform apply -auto-approve\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Region selection is derived from ",(0,s.jsx)(n.code,{children:"AWS_DEFAULT_REGION"})," and propagated consistently across all Terraform modules."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"environment-propagation-model",children:"Environment Propagation Model"}),"\n",(0,s.jsxs)(n.p,{children:["All configuration is consolidated into a single ",(0,s.jsx)(n.code,{children:".env"})," file generated during setup."]}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:".env"})," file is copied into:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"django/"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"docker/containers-update/"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"docker/vbrowser-stack/"})}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"This ensures:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Configuration consistency"}),"\n",(0,s.jsx)(n.li,{children:"Single source of truth"}),"\n",(0,s.jsx)(n.li,{children:"Predictable runtime behavior"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"No service maintains its own independent configuration store."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"image-management-layer-containers-updater",children:"Image Management Layer (containers-updater)"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"containers-updater"})," service is responsible for:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Building browser Docker images"}),"\n",(0,s.jsx)(n.li,{children:"Tagging images deterministically"}),"\n",(0,s.jsx)(n.li,{children:"Pushing images to AWS ECR"}),"\n",(0,s.jsx)(n.li,{children:"Preparing images for ECS consumption"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["This process runs ",(0,s.jsx)(n.strong,{children:"once per deployment"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"Operators must wait for the updater to complete before starting browser sessions."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"application-runtime-layer-vbrowser-backend",children:"Application Runtime Layer (vBrowser Backend)"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"vbrowser"})," service is a Django-based backend that provides:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"API endpoints"}),"\n",(0,s.jsx)(n.li,{children:"Session lifecycle management"}),"\n",(0,s.jsx)(n.li,{children:"Authentication and authorization"}),"\n",(0,s.jsx)(n.li,{children:"Idle timeout enforcement"}),"\n",(0,s.jsx)(n.li,{children:"ECS task orchestration"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"It depends on:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"PostgreSQL (persistent state)"}),"\n",(0,s.jsx)(n.li,{children:"Redis (ephemeral coordination)"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["The backend does ",(0,s.jsx)(n.strong,{children:"not"})," execute browsers directly."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"browser-execution-layer",children:"Browser Execution Layer"}),"\n",(0,s.jsx)(n.p,{children:"Each browser session is executed as:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"A dedicated ECS task"}),"\n",(0,s.jsx)(n.li,{children:"A single browser per container"}),"\n",(0,s.jsx)(n.li,{children:"An isolated filesystem"}),"\n",(0,s.jsx)(n.li,{children:"No shared state between sessions"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Characteristics:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Fully ephemeral"}),"\n",(0,s.jsx)(n.li,{children:"Destroyed on termination or idle timeout"}),"\n",(0,s.jsx)(n.li,{children:"No persistence of cookies, cache, or files"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Browser containers are read-only consumers of browser images."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"data-flow-summary",children:"Data Flow Summary"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Operator runs ",(0,s.jsx)(n.code,{children:"setup.sh"})]}),"\n",(0,s.jsx)(n.li,{children:"Infrastructure is provisioned via Terraform"}),"\n",(0,s.jsx)(n.li,{children:"Browser images are built and pushed"}),"\n",(0,s.jsx)(n.li,{children:"Backend services are started via Docker Compose"}),"\n",(0,s.jsx)(n.li,{children:"Browser sessions are launched on-demand in ECS"}),"\n",(0,s.jsx)(n.li,{children:"Sessions terminate and are destroyed automatically"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"At no point does untrusted content reach the operator\u2019s local system."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"trust--isolation-boundaries",children:"Trust & Isolation Boundaries"}),"\n",(0,s.jsx)(n.p,{children:"OvB enforces strict boundaries:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Local host never executes browser code"}),"\n",(0,s.jsx)(n.li,{children:"Backend does not share browser state"}),"\n",(0,s.jsx)(n.li,{children:"Browsers do not share storage"}),"\n",(0,s.jsx)(n.li,{children:"Infrastructure access is IAM-scoped"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Each layer assumes the others may fail and limits blast radius accordingly."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"design-principles",children:"Design Principles"}),"\n",(0,s.jsx)(n.p,{children:"OvB is built around the following principles:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Ephemeral by default"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Explicit operator control"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Minimal long-lived state"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Infrastructure as code"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Fail-safe teardown"})}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"These principles guide all architectural decisions."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,s.jsx)(n.p,{children:"To understand OvB\u2019s security guarantees in depth:"}),"\n",(0,s.jsxs)(n.p,{children:["Continue to ",(0,s.jsx)(n.strong,{children:"Security Model"})]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453(e,n,r){r.d(n,{R:()=>l,x:()=>o});var i=r(6540);const s={},t=i.createContext(s);function l(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),i.createElement(t.Provider,{value:n},e.children)}},8566(e,n,r){r.d(n,{A:()=>i});const i=r.p+"assets/images/diagram-transparent-dark-9e091c7e94e78e3595f9fb07f9ae0388.png"}}]);